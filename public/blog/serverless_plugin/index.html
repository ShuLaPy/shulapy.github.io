<!DOCTYPE html>




































<html
  class="not-ready lg:text-base"
  style="--bg: #faf8f1"
  lang="en-us"
>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  
  <title>Creating a Plugin for Serverless Framework - Shubham Lad</title>

  
  <meta name="theme-color" />

  
  
  
  <meta name="description" content="
Working on a project in my company brought forward the need to customize this open-source serverless plugin, serverless-appsync-plugin further, to match our requirements. The deeper I went through the plugin, the more interested I became to discover more intricacies associated with it. In the process, I learned a few things that go into writing a serverless plugin. In this article, I will share some basic ideas to help you get started with developing your plugin." />
  <meta name="author" content="Brief Description" />
  

  
  
  
  
  
  
  <link rel="preload stylesheet" as="style" href="http://localhost:1313/main.min.css" />

  
  <script
    defer
    src="http://localhost:1313/highlight.min.js"
    onload="hljs.initHighlightingOnLoad();"
  ></script>
  

  
   
  <link rel="preload" as="image" href="http://localhost:1313/theme.png" />

  
  
  
  <link rel="preload" as="image" href="https://www.gravatar.com/avatar/733ed220a859026ff7dba915d2c1c693?s=160&amp;d=identicon" />
  
  

  
  

  
  

  
  <link rel="icon" href="http://localhost:1313/favicon.ico" />
  <link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png" />

  
  <meta name="generator" content="Hugo 0.135.0">

  
  

  
  
</head>

  <body class="text-black duration-200 ease-out dark:text-white">
    <header class="mx-auto flex h-[4.5rem] max-w-3xl px-8 lg:justify-center">
  <div class="relative z-50 mr-auto flex items-center">
    <a
      class="-translate-x-[1px] -translate-y-[1px] text-2xl font-semibold"
      href="http://localhost:1313/"
      >Shubham Lad</a
    >
    <div
      class="btn-dark text-[0] ml-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]"
      role="button"
      aria-label="Dark"
    ></div>
  </div>

  <div
    class="btn-menu relative z-50 -mr-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
    role="button"
    aria-label="Menu"
  ></div>

  
  <script>
    
    const htmlClass = document.documentElement.classList;
    setTimeout(() => {
      htmlClass.remove('not-ready');
    }, 10);

    
    const btnMenu = document.querySelector('.btn-menu');
    btnMenu.addEventListener('click', () => {
      htmlClass.toggle('open');
    });

    
    const metaTheme = document.querySelector('meta[name="theme-color"]');
    const lightBg = '#faf8f1'.replace(/"/g, '');
    const setDark = (isDark) => {
      metaTheme.setAttribute('content', isDark ? '#000' : lightBg);
      htmlClass[isDark ? 'add' : 'remove']('dark');
      localStorage.setItem('dark', isDark);
    };

    
    const darkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    if (htmlClass.contains('dark')) {
      setDark(true);
    } else {
      const darkVal = localStorage.getItem('dark');
      setDark(darkVal ? darkVal === 'true' : darkScheme.matches);
    }

    
    darkScheme.addEventListener('change', (event) => {
      setDark(event.matches);
    });

    
    const btnDark = document.querySelector('.btn-dark');
    btnDark.addEventListener('click', () => {
      setDark(localStorage.getItem('dark') !== 'true');
    });
  </script>

  <div
    class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"
  >
    
    
    <nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-6">
      
      <a
        class="block text-center text-2xl leading-[5rem] lg:text-base lg:font-normal"
        href="/blog/"
        >📝 Blog</a
      >
      
      <a
        class="block text-center text-2xl leading-[5rem] lg:text-base lg:font-normal"
        href="/papershelf/"
        >📑 Papershelf</a
      >
      
      <a
        class="block text-center text-2xl leading-[5rem] lg:text-base lg:font-normal"
        href="/bookshelf/"
        >📚 Bookshelf</a
      >
      
      <a
        class="block text-center text-2xl leading-[5rem] lg:text-base lg:font-normal"
        href="/about/"
        >😎 About Me</a
      >
      
    </nav>
    

    
  </div>
</header>


    <main
      class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-3xl px-8 pb-16 pt-12 dark:prose-invert"
    >
      

<article>
  <header class="mb-16">
    <h1 class="!my-0 pb-2.5">Creating a Plugin for Serverless Framework</h1>

    
    <div class="text-sm antialiased opacity-60">
      
      <time>Jun 10, 2024</time>
      
      
      
      
    </div>
    
  </header>

  <section><p><img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExaHpzdDRranNzdXRxOGw1dWJtb3ZxbXVrcndiaXc5Nzk3NjBweDh2MyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/QvGCMeHuP1vLYl2hLb/giphy-downsized.gif" alt="plugin"></p>
<p>Working on a project in my company brought forward the need to customize this open-source serverless plugin, <code>serverless-appsync-plugin</code> further, to match our requirements. The deeper I went through the plugin, the more interested I became to discover more intricacies associated with it. In the process, I learned a few things that go into writing a serverless plugin. In this article, I will share some basic ideas to help you get started with developing your plugin.</p>
<h1 id="introduction">Introduction</h1>
<p>The Serverless Framework is a pretty solid tool because it helps the user build and deploy serverless applications. While the framework is packed with numerous powerful features, the real power is unleashed when using plugins. Plugins allow developers to extend and customize the functionality of the Serverless Framework to meet their specific requirements. This blog will lead you through the process of creating your first plugin for the Serverless Framework.</p>
<h1 id="understanding-serverless-framework">Understanding Serverless Framework</h1>
<p>The Serverless Framework is an open-source application framework that simplifies the deployment of serverless applications across various cloud providers. It abstracts away the pains of managing serverless architecture. Therefore developers can fully focus on writing code rather than managing infrastructure</p>
<p>The Serverless Framework significantly reduces the operational overhead and speeds up the process of serverless application development.</p>
<h1 id="what-are-plugins-in-serverless-framework">What Are Plugins in Serverless Framework?</h1>
<p>Serverless Framework plugins are just tools to extend the capability of the framework. They can bring changes to the behavior of the framework, add new commands, or integrate with other tools and services Some of the most used plugins are monitoring security, and deployment automation. Developers can create custom plugins to make the framework best suited to their project requirements.</p>
<h1 id="lets-create-a-plugin">Let&rsquo;s create a plugin</h1>
<h4 id="step-1-setting-up-the-project">Step 1: Setting up the Project</h4>
<p>First, initialize a new Node.js project:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir my-serverless-plugin
</span></span><span style="display:flex;"><span>cd my-serverless-plugin
</span></span><span style="display:flex;"><span>npm init -y
</span></span></code></pre></div><p>Next, set up the project structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>my-serverless-plugin/
</span></span><span style="display:flex;"><span>├── src/
</span></span><span style="display:flex;"><span>│   └── index.js
</span></span><span style="display:flex;"><span>├── test/
</span></span><span style="display:flex;"><span>│   └── index.test.js
</span></span><span style="display:flex;"><span>├── package.json // make sure you mention the <span style="color:#e6db74">`</span>main<span style="color:#e6db74">`</span> file
</span></span><span style="display:flex;"><span>└── README.md
</span></span></code></pre></div><p>Note: we are not covering the test part</p>
<h4 id="step-2-creating-the-plugin-class">Step 2: Creating the Plugin Class</h4>
<p>Every serverless plugin is a class that is instantiated with two arguments: the serverless object and a set of options.</p>
<p>In src/index.js, define the plugin class:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyServerlessPlugin</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">serverless</span>, <span style="color:#a6e22e">options</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">serverless</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">options</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">hooks</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;before:deploy:deploy&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">beforeDeploy</span>.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">this</span>),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">beforeDeploy</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span>.<span style="color:#a6e22e">cli</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Executing before deploy hook!&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">MyServerlessPlugin</span>;
</span></span></code></pre></div><p>Don&rsquo;t worry about the <code>hooks</code> and <code>commands</code> here yet; we&rsquo;ll get to them after we&rsquo;ve done the most important part of setting up the plugin system.</p>
<h4 id="step-3-adding-functionality-to-the-plugin">Step 3: Adding Functionality to the Plugin</h4>
<p>Extend your plugin by hooking in lifecycle events of Serverless Framework, adding your custom commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyServerlessPlugin</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">serverless</span>, <span style="color:#a6e22e">options</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">serverless</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">options</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">commands</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">mycommand</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">usage</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Describe your custom command here&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">lifecycleEvents</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;run&#34;</span>],
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">hooks</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;before:deploy:deploy&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">beforeDeploy</span>.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">this</span>),
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;mycommand:run&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">runMyCommand</span>.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">this</span>),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">beforeDeploy</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span>.<span style="color:#a6e22e">cli</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Executing before deploy hook!&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">runMyCommand</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span>.<span style="color:#a6e22e">cli</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Running my custom command!&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">MyServerlessPlugin</span>;
</span></span></code></pre></div><p>You can see these commands when you run <code>serverless --help</code>.</p>
<h4 id="step-4-testing-the-plugin">Step 4: Testing the Plugin</h4>
<p>Now create a test serverless project in another directory, also install and configure your plugin:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ serverless
</span></span><span style="display:flex;"><span>$ cd my-serverless-project
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm install /path/to/my-serverless-plugin
</span></span></code></pre></div><p>In your serverless.yml:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">plugins</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">my-serverless-plugin</span>
</span></span></code></pre></div><p>Now, test if the plugin is configured correctly. To test, run the command given below, and you should see <code>mycommand</code> in the list.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>serverless --help
</span></span></code></pre></div><p>Run your custom command to test:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>serverless mycommand
</span></span></code></pre></div><h1 id="commands">Commands</h1>
<p>Serverless Framework plugins can define commands, adding custom functionality later to be executed via the Serverless CLI. By defining commands, you can extend the Serverless Framework with new capabilities tailored to your specific use case.</p>
<h4 id="defining-commands">Defining Commands</h4>
<p>To define a command in your plugin, you need to specify it in the commands object within your plugin class. Each command consists of a name, usage description, and a list of lifecycle events that the command will trigger.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyServerlessPlugin</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">serverless</span>, <span style="color:#a6e22e">options</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">serverless</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">options</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Define custom commands
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">commands</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">mycommand</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">usage</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Describe what your custom command does&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">lifecycleEvents</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;run&#34;</span>],
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">hooks</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;mycommand:run&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">runMyCommand</span>.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">this</span>),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">runMyCommand</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span>.<span style="color:#a6e22e">cli</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Running my custom command!&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">MyServerlessPlugin</span>;
</span></span></code></pre></div><h4 id="command-options-and-lifecycle-events">Command Options and Lifecycle events</h4>
<p>Commands can also accept options. Options allow you to pass parameters at the time of executing a particular command. Options are defined within the command object.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">commands</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mycommand</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">usage</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Describe what your custom command does&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lifecycleEvents</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;run&#34;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">options</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// this is the option you can pass from command line
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">usage</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Specify the name option (e.g., --name John)&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">required</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">shortcut</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;n&#34;</span>,
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>When running the command, users can pass options as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>serverless mycommand --name John
</span></span></code></pre></div><p>You can access these options in your command method:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">runMyCommand</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">name</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span>.<span style="color:#a6e22e">cli</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Running my custom command with name: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">name</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="command-lifecycle-events">Command Lifecycle Events</h4>
<p>Commands can have multiple lifecycle events, each representing a different stage in the command execution process. For instance, a command might have start, process, and end events.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">commands</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mycommand</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">usage</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Describe what your custom command does&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lifecycleEvents</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;start&#34;</span>, <span style="color:#e6db74">&#34;process&#34;</span>, <span style="color:#e6db74">&#34;end&#34;</span>],
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">hooks</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;mycommand:start&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">startCommand</span>.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">this</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;mycommand:process&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">processCommand</span>.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">this</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;mycommand:end&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">endCommand</span>.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">this</span>),
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h4 id="provider-specific-plugins">Provider-specific plugins</h4>
<p>Plugins can be provider specific, that means they run only with a particular provider.</p>
<p>Note: Binding a provider to a plugin is optional. Serverless will always consider your plugin if you don&rsquo;t specify a provider.</p>
<p>To bind with a specified provider, retrieve it, and set the this.provider property in the constructor of the plug-in:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyServerlessPlugin</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">serverless</span>, <span style="color:#a6e22e">options</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// bind to a specific provider
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">provider</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">serverless</span>.<span style="color:#a6e22e">getProvider</span>(<span style="color:#e6db74">&#34;providerX&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="lets-build-something">Let&rsquo;s build something</h1>
<p>Now that you know the basics, let&rsquo;s do something practical. We&rsquo;ll add more to enhance the serverless capabilities of our tools by adding a <code>get-stack</code> command. This way, we can retrieve information about the stack via the AWS describeStacks command.</p>
<p>First, we will create a class and include a provider for AWS. Then, we will add a custom command with a life cycle event.</p>
<p>The <code>serverless</code> parameter grants you access to all the methods provided by Serverless. Refer to the official documentation for other capabilities.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyServerlessPlugin</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">serverless</span>, <span style="color:#a6e22e">options</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">serverless</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">options</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">provider</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span>.<span style="color:#a6e22e">getProvider</span>(<span style="color:#e6db74">&#34;aws&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">commands</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;get-stack&#34;</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">lifecycleEvents</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;run&#34;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">options</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">usage</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Specify the name of stack (e.g., --name dev-stack)&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">required</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shortcut</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;n&#34;</span>,
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">hooks</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;get-stack:run&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getStackInfo</span>.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">this</span>),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">getStackName</span>() {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Now we have a provider prepared, so we will be able to execute different AWS commands with this provider. That means now all the commands with respect to AWS can be executed without problems.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>  <span style="color:#66d9ef">async</span> <span style="color:#a6e22e">getStackName</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">name</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">provider</span>.<span style="color:#a6e22e">request</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;CloudFormation&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;describeStacks&#34;</span>,
</span></span><span style="display:flex;"><span>      { <span style="color:#a6e22e">StackName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">name</span> }
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">serverless</span>.<span style="color:#a6e22e">cli</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Response: &#34;</span>, <span style="color:#a6e22e">response</span>); <span style="color:#75715e">// use serverless.log
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span></code></pre></div><p>If you run <code>serverless --help</code> command now you will see:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MyServerlessPlugin
</span></span><span style="display:flex;"><span>get-stack
</span></span></code></pre></div><p>run this command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>serverless get-stack --name dev-stack
</span></span></code></pre></div></section>

  
  

  
  
  
  <nav class="mt-24 flex rounded-lg bg-black/[3%] text-lg dark:bg-white/[8%]">
    
    <a
      class="flex w-1/2 items-center rounded-l-md p-6 pr-3 font-semibold no-underline hover:bg-black/[2%] dark:hover:bg-white/[3%]"
      href="http://localhost:1313/blog/git_reset_right_way/"
      ><span class="mr-1.5">←</span><span>Learning from mistakes - Revert/Reset the branch in right way.</span></a
    >
    
    
    <a
      class="ml-auto flex w-1/2 items-center justify-end rounded-r-md p-6 pl-3 font-semibold no-underline hover:bg-black/[2%] dark:hover:bg-white/[3%]"
      href="http://localhost:1313/blog/what_is_nat/"
      ><span>Network Address Translation (NAT): Bridging the Gap in IP Addressing</span><span class="ml-1.5">→</span></a
    >
    
  </nav>
  

  
  

  
  
</article>


    </main>

    <footer
  class="opaco mx-auto flex h-[4.5rem] max-w-3xl items-center px-8 text-[0.9em] opacity-60"
>
  <div class="mr-auto">
    &copy; 2024
    <a class="link" href="http://localhost:1313/">Shubham Lad</a>
  </div>
  <a class="link mx-6" href="https://gohugo.io/" rel="noopener" target="_blank"
    >Powered by Hugo️️</a
  >️
  <a
    class="link"
    href="https://github.com/nanxiaobei/hugo-paper"
    rel="noopener"
    target="_blank"
    >✎ Paper</a
  >
</footer>

  </body>
</html>
